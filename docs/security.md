# Политика безопасности и реализация защиты

В проекте «СистемаКонтроля» безопасность является приоритетом. Мы используем многоуровневый подход к защите данных и разграничению доступа.

## 1. Аутентификация и Хранение паролей

Мы не храним пароли в открытом виде. Для хеширования используется современный алгоритм **Argon2**, который устойчив к атакам перебора на GPU.

**Конфигурация (`settings.py`):**
```python
PASSWORD_HASHERS = [
    'django.contrib.auth.hashers.Argon2PasswordHasher',
    'django.contrib.auth.hashers.PBKDF2PasswordHasher',
    ...
]
```

## 2. Ролевая модель доступа (RBAC)

Доступ к ресурсам строго регламентирован на уровне кода (`defects/permissions.py` и `models.py`).

| Роль | Права доступа |
| :--- | :--- |
| **Инженер** | Может создавать дефекты и видеть только назначенные на него задачи. Не может удалять данные или видеть чужие задачи. |
| **Менеджер** | Полный доступ (CRUD) ко всем проектам и дефектам. Может назначать исполнителей и менять статусы. |
| **Заказчик** | Только чтение (Read-only). Доступ к дашбордам и аналитике. |

**Пример проверки прав:**
```python
def can_edit(self, user) -> bool:
    if user.is_manager:
        return True
    if user.is_engineer and self.executor_id == user.id:
        return self.status not in {Defect.Status.CLOSED}
    return False
```

## 3. Защита веб-приложения

В `settings.py` включены стандартные механизмы защиты Django:

*   **CSRF Protection**: Защита от межсайтовой подделки запросов включена глобально.
*   **XSS Protection**:
    *   `SECURE_BROWSER_XSS_FILTER = True`
    *   Автоматическое экранирование в шаблонах Django.
*   **Clickjacking**: `X_FRAME_OPTIONS = 'DENY'` запрещает встраивание сайта в iframe.
*   **Content Sniffing**: `SECURE_CONTENT_TYPE_NOSNIFF = True`.
*   **Secure Cookies**: В продакшн-режиме (`DEBUG=False`) куки сессии и CSRF передаются только по HTTPS (`SESSION_COOKIE_SECURE = True`).

## 4. Безопасная конфигурация

*   **Переменные окружения**: Секретные ключи (`SECRET_KEY`), пароли БД и настройки отладки не хранятся в коде, а загружаются из `.env` файла.
*   **Docker**: Приложение запускается от непривилегированного пользователя (в перспективе), база данных изолирована во внутренней сети Docker.

## 5. Аудит кода

Для статического анализа безопасности используется **Bandit**.
Запуск проверки:
```bash
bandit -r .
```
